<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Batchmate Profile</title>
<style>
  body {
    margin:0;
    font-family:'Arial',sans-serif;
    background-color:#000;
    color:#FFD700;
    padding:15px;
    line-height:1.6;
  }

  .profile-container {
    max-width:600px;
    margin:0 auto;
    text-align:left;
    padding:15px;
  }

  .profile-image {
    width:150px;
    max-width:100%;
    height:auto;
    object-fit:cover;
    border-radius:12px;
    border:2px solid #FFD700;
    margin-bottom:10px;
    cursor: zoom-in; /* optional for fullscreen effect later */
  }

  h2 {
    margin:10px 0;
    font-size:1.5em;
  }

  #profileBio p {
    margin:10px 0;
  }

  a.back {
    display:inline-block;
    margin-top:20px;
    color:#FFD700;
    text-decoration:none;
    border:1px solid #FFD700;
    padding:5px 12px;
    border-radius:5px;
    transition:all 0.3s ease;
  }

  a.back:hover {
    background-color:#FFD700;
    color:#000;
    transform: scale(1.05);
  }

  @media (max-width:600px){
    .profile-container { padding:10px; }
  }
</style>
</head>

<body>
<div class="profile-container">
  <img id="profileImage" class="profile-image" src="" alt="Profile Image">
  <h2 id="profileName"></h2>
  <div id="profileBio"></div>
  <a href="index.html" class="back">&larr; Back to Homepage</a>
</div>

<script>
async function loadProfile() {
  const params = new URLSearchParams(window.location.search);
  const bioFile = params.get('bio'); // bioFile parameter from URL

  if(!bioFile) return;

  // Fetch directory.json to find the matching entry
  const data = await (await fetch('directory.json')).json();
  const person = data.find(p => p.bioFile === bioFile);

  if(person){
    // Set profile image & name
    document.getElementById('profileImage').src = person.image;
    document.getElementById('profileImage').alt = person.name;
    document.getElementById('profileName').textContent = person.name;

    // Fetch bio text/html
    try {
      const bioText = await (await fetch(person.bioFile)).text();
      // Split by double newlines to make paragraphs
      document.getElementById('profileBio').innerHTML = bioText
        .split(/\n\s*\n/) 
        .map(para => `<p>${para.trim()}</p>`)
        .join('');
    } catch(e){
      document.getElementById('profileBio').textContent = "Bio not available.";
      console.error("Error loading bio:", e);
    }
  }
}

loadProfile();
</script>
</body>
</html>
